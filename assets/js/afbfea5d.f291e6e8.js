"use strict";(self.webpackChunkicmsite_docusaurus=self.webpackChunkicmsite_docusaurus||[]).push([[911],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>g});var n=a(7294);function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,p=function(e,t){if(null==e)return{};var a,n,p={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(p[a]=e[a]);return p}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(p[a]=e[a])}return p}var o=n.createContext({}),s=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(o.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,p=e.mdxType,r=e.originalType,o=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=s(a),u=p,g=m["".concat(o,".").concat(u)]||m[u]||d[u]||r;return a?n.createElement(g,l(l({ref:t},c),{},{components:a})):n.createElement(g,l({ref:t},c))}));function g(e,t){var a=arguments,p=t&&t.mdxType;if("string"==typeof e||p){var r=a.length,l=new Array(r);l[0]=u;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[m]="string"==typeof e?e:p,l[1]=i;for(var s=2;s<r;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},6451:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var n=a(7462),p=(a(7294),a(3905));const r={},l="Cheatsheet",i={unversionedId:"yuanzhong/cheatsheet",id:"yuanzhong/cheatsheet",title:"Cheatsheet",description:"app-energy-go",source:"@site/docs/yuanzhong/cheatsheet.md",sourceDirName:"yuanzhong",slug:"/yuanzhong/cheatsheet",permalink:"/docs/yuanzhong/cheatsheet",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/yuanzhong/cheatsheet.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"YZ",permalink:"/docs/yuanzhong/"}},o={},s=[{value:"app-energy-go",id:"app-energy-go",level:2},{value:"Windows \u7ec8\u7aef Terminal",id:"windows-\u7ec8\u7aef-terminal",level:3},{value:"\u542f\u52a8Nginx\u548cPHP-FPM",id:"\u542f\u52a8nginx\u548cphp-fpm",level:3},{value:"\u542f\u52a8\u542f\u52a8\u5fae\u670d\u52a1",id:"\u542f\u52a8\u542f\u52a8\u5fae\u670d\u52a1",level:3},{value:"\u6211\u65e7\u5e73\u53f0api\u548crpc\u751f\u6210",id:"\u6211\u65e7\u5e73\u53f0api\u548crpc\u751f\u6210",level:3},{value:"\u65e7\u5e73\u53f0 \u81ea\u52a8Docker\u6253\u5305\u5e76\u63a8\u9001",id:"\u65e7\u5e73\u53f0-\u81ea\u52a8docker\u6253\u5305\u5e76\u63a8\u9001",level:3},{value:"\u751f\u6210\u6a21\u578b\u3000Model",id:"\u751f\u6210\u6a21\u578bmodel",level:3},{value:"\u7f16\u8bd1\u6253\u5305\u548cDocker Image Push",id:"\u7f16\u8bd1\u6253\u5305\u548cdocker-image-push",level:3},{value:"html-energy \u6253\u5305\u7f16\u8bd1",id:"html-energy-\u6253\u5305\u7f16\u8bd1",level:2},{value:"App-System\u524d\u7aef\u9879\u76ee",id:"app-system\u524d\u7aef\u9879\u76ee",level:2},{value:"app-iot-3",id:"app-iot-3",level:2},{value:"\u751f\u6210\u6a21\u578b",id:"\u751f\u6210\u6a21\u578b",level:3},{value:"\u751f\u6210Logic",id:"\u751f\u6210logic",level:3},{value:"\u751f\u6210TS",id:"\u751f\u6210ts",level:3},{value:"\u751f\u6210\u4ed3\u5e93\u4ee3\u7801",id:"\u751f\u6210\u4ed3\u5e93\u4ee3\u7801",level:3},{value:"\u65b0\u7cfb\u7edf\u4e00\u4e9b\u91cd\u6784\u6307\u4ee4",id:"\u65b0\u7cfb\u7edf\u4e00\u4e9b\u91cd\u6784\u6307\u4ee4",level:2},{value:"\u5b9a\u5236\u751f\u6210ts",id:"\u5b9a\u5236\u751f\u6210ts",level:2},{value:"app-iot-goctl \u5b9a\u5236\u5f00\u53d1",id:"app-iot-goctl-\u5b9a\u5236\u5f00\u53d1",level:2},{value:"\u65b0\u5e73\u53f0\u540e\u7aef\u7f16\u8bd1\u6253\u5305\u5e76\u63a8\u9001",id:"\u65b0\u5e73\u53f0\u540e\u7aef\u7f16\u8bd1\u6253\u5305\u5e76\u63a8\u9001",level:2}],c={toc:s},m="wrapper";function d(e){let{components:t,...a}=e;return(0,p.kt)(m,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("h1",{id:"cheatsheet"},"Cheatsheet"),(0,p.kt)("h2",{id:"app-energy-go"},"app-energy-go"),(0,p.kt)("p",null,"\u9879\u76ee: app-energy-go"),(0,p.kt)("p",null,"\u76ee\u5f55\uff1a ",(0,p.kt)("inlineCode",{parentName:"p"},"\\\\wsl$\\Ubuntu-20.04\\srv\\app-energy-go")),(0,p.kt)("h3",{id:"windows-\u7ec8\u7aef-terminal"},"Windows \u7ec8\u7aef Terminal"),(0,p.kt)("p",null,"\u6279\u91cf\u6253\u5f00 Hyperf Terminal"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-cmd"},'wt -p "APP-Farm+System"; split-pane -V  -p "APP-Farm+System"; new-tab -p "Service-Acl+Auth"; split-pane -V  -p "Service-Acl+Auth" ; new-tab -p "Service-Broadcast+Device"; split-pane -V  -p "Service-Broadcast+Device"; new-tab -p "Service-DeviceReciever+Group"; split-pane -V  -p "Service-DeviceReciever+Group"; new-tab -p "Service-Notice+Report"; split-pane -V  -p "Service-Notice+Report"; new-tab -p "Service-Trigger+Weather"; split-pane -V  -p "Service-Trigger+Weather"; new-tab -p "Service-Simdata+common"; split-pane -V  -p "Service-Simdata+common"; new-tab  -p "Ubuntu-20.04" --title Ubuntu-20.04\n')),(0,p.kt)("p",null,"\u6279\u91cf\u6253\u5f00 Go-Zero Terminal"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-cmd"},'wt -p "Usercenter"; split-pane -V  -p "Usercenter"; new-tab -p "Sms"; split-pane -V  -p "Sms" ;  new-tab -p "Device"; split-pane -V  -p "Device" ; new-tab -p "GoGroup"; split-pane -V  -p "GoGroup"; new-tab -p "GoTrigger"; split-pane -V  -p "GoTrigger";new-tab -p "GoStats"; split-pane -V  -p "GoStats";new-tab -p "GoCtrl"; split-pane -V  -p "GoCtrl"; new-tab -p "Ubuntu-20.04"; split-pane -V  -p "Ubuntu-20.04" --title Ubuntu-20.04\n')),(0,p.kt)("h3",{id:"\u542f\u52a8nginx\u548cphp-fpm"},"\u542f\u52a8Nginx\u548cPHP-FPM"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"/srv/http# service nginx start\n\n/srv/http# service php7.4-fpm start\n")),(0,p.kt)("h3",{id:"\u542f\u52a8\u542f\u52a8\u5fae\u670d\u52a1"},"\u542f\u52a8\u542f\u52a8\u5fae\u670d\u52a1"),(0,p.kt)("p",null,"Hyperf"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-sh"},"cd app-farm && php bin/hyperf.php server:watch\ncd app-system && php bin/hyperf.php server:watch\n\ncd service-acl && php bin/hyperf.php server:watch\ncd service-auth && php bin/hyperf.php server:watch\n\ncd service-broadcast && php bin/hyperf.php server:watch\ncd service-device && php bin/hyperf.php server:watch\n\ncd service-device-reciever && php bin/hyperf.php server:watch\ncd service-group && php bin/hyperf.php server:watch\n\ncd service-notice && php bin/hyperf.php server:watch\ncd service-report && php bin/hyperf.php server:watch\n\ncd service-trigger && php bin/hyperf.php server:watch\ncd service-weather && php bin/hyperf.php server:watch\n \ncd service-simdata && php bin/hyperf.php server:watch\ncd service-common && php bin/hyperf.php server:watch\n")),(0,p.kt)("p",null,"Go-Zero app-energy-go"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"$ cd rpc && air\n$ cd api && air\n")),(0,p.kt)("h3",{id:"\u6211\u65e7\u5e73\u53f0api\u548crpc\u751f\u6210"},"\u6211\u65e7\u5e73\u53f0api\u548crpc\u751f\u6210"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"# service/device/api \u76ee\u5f55\u4e0b\u6267\u884c\ngoctl api go -api *.api -dir ./  --style=goZero  // \u540e\u671f\u53ef\u4ee5\u8003\u8651\u53ef\u4ee5\u52a0 --home ./tpl\n\n# service/device/rpc/pb \u76ee\u5f55\u4e0b\u6267\u884c\ngoctl rpc protoc *.proto --go_out=../ --go-grpc_out=../  --zrpc_out=../ --style=goZero  // \u540e\u671f\u53ef\u4ee5\u8003\u8651\u52a0 --home ./tpl\n")),(0,p.kt)("h3",{id:"\u65e7\u5e73\u53f0-\u81ea\u52a8docker\u6253\u5305\u5e76\u63a8\u9001"},"\u65e7\u5e73\u53f0 \u81ea\u52a8Docker\u6253\u5305\u5e76\u63a8\u9001"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"$ cd /srv/app-energy-go // \u8fdb\u5165\u5230\u9879\u76ee\u6839\u76ee\u5f55\n$ make push-latest name=usercenter-rpc // \u53ea\u63a8\u9001\n\n$ make push app=device/api name=device-api // \u6253\u5305\u5e76\u53ea\u63a8\u9001\n\n$ make push app=device/rpc name=device-rpc // \u6253\u5305\u5e76\u53ea\u63a8\u9001\n\n$ make push app=stats/rpc name=stats-rpc\n$ make push app=stats/api name=stats-api\n")),(0,p.kt)("h3",{id:"\u751f\u6210\u6a21\u578bmodel"},"\u751f\u6210\u6a21\u578b\u3000Model"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="\u751f\u6210\u6a21\u578b"',title:'"\u751f\u6210\u6a21\u578b"'},'goctl14 model mysql ddl -src="./service/device/model/groups.sql" -dir="./service/device/model" -style=goZero -c --home=.goctl\ngoctl14 model mysql ddl -src="./service/device/model/virtual_device_group.sql" -dir="./service/device/model" -style=goZero -c --home=.goctl\n')),(0,p.kt)("p",null,"\u8fd9\u91cc\u6709\u51e0\u4e2a\u5173\u952e\u53c2\u6570"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},"goctl\u7248\u672c\u662f14(\u6700\u65e9\u4f7f\u7528Go-Zero\u65f6\u7528\u7684goctl13\uff0c\u540e\u6765\u5347\u7ea7\u5230\u4e8614)"),(0,p.kt)("li",{parentName:"ol"},"\u5728 ",(0,p.kt)("inlineCode",{parentName:"li"},"app-energy-go")," \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u6267\u884c"),(0,p.kt)("li",{parentName:"ol"},"\u53c2\u6570 ",(0,p.kt)("inlineCode",{parentName:"li"},"-c")," \u5e26\u7f13\u5b58"),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("inlineCode",{parentName:"li"},"--home=.goctl")," \u751f\u6210\u6a21\u677f\u76ee\u5f55")),(0,p.kt)("h3",{id:"\u7f16\u8bd1\u6253\u5305\u548cdocker-image-push"},"\u7f16\u8bd1\u6253\u5305\u548cDocker Image Push"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd /srv/app-energy-go\n\n$ make push-latest name=usercenter-rpc # \u53ea\u63a8\u9001\n\n$ make push app=device/api name=device-api # \u7f16\u8bd1\u5e76\u63a8\u9001\n\n$ make push app=device/rpc name=device-rpc # \u7f16\u8bd1\u5e76\u63a8\u9001\n")),(0,p.kt)("p",null,"\u9047\u5230\u95ee\u9898\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'=> ERROR [builder 1/9] FROM docker.io/library/golang:alpine@sha256:7839c9f01b5502d7cb5198b2c  132.1s\n...\n > [builder 1/9] FROM docker.io/library/golang:alpine@sha256:7839c9f01b5502d7cb5198b2c032857023424470b3e31ae46a8261ffca72912a:\n------\nfailed commit on ref "layer-sha256:31e352740f534f9ad170f75378a84fe453d6156e40700b882d737a8f4a6988a3"\n')),(0,p.kt)("p",null,"\u95eeAI\u8bf4\uff1a"),(0,p.kt)("p",null,"\u8fd9\u4e2a\u9519\u8bef\u63d0\u793a\u662f\u5728\u4f7f\u7528 Docker \u6784\u5efa\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u9519\u8bef\u6307\u793a\u5728\u6784\u5efa\u8fc7\u7a0b\u7684\u7b2c\u4e00\u4e2a\u6b65\u9aa4\u4e2d\uff0c\u4ece docker.io/library/golang \u955c\u50cf\u83b7\u53d6\u5931\u8d25\u3002"),(0,p.kt)("p",null,"\u8fd9\u4e2a\u9519\u8bef\u53ef\u80fd\u6709\u4ee5\u4e0b\u51e0\u4e2a\u539f\u56e0\uff1a"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u7f51\u7edc\u8fde\u63a5\u95ee\u9898\uff1a\u6784\u5efa\u8fc7\u7a0b\u65e0\u6cd5\u8fde\u63a5\u5230 docker.io \u670d\u52a1\u5668\u6765\u83b7\u53d6\u6240\u9700\u7684\u955c\u50cf\u3002\u8bf7\u786e\u4fdd\u4f60\u7684\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u91cd\u65b0\u8fd0\u884c\u6784\u5efa\u547d\u4ee4\u3002")),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u955c\u50cf\u4e0d\u5b58\u5728\uff1adocker.io/library/golang \u955c\u50cf\u53ef\u80fd\u4e0d\u5b58\u5728\u6216\u88ab\u79fb\u9664\u3002\u4f60\u53ef\u4ee5\u5728 Docker Hub \u6216\u5176\u4ed6\u955c\u50cf\u4ed3\u5e93\u4e2d\u9a8c\u8bc1\u8be5\u955c\u50cf\u662f\u5426\u53ef\u7528\u3002"))),(0,p.kt)("p",null,". \u8bbf\u95ee\u6743\u9650\u95ee\u9898\uff1a\u4f60\u53ef\u80fd\u6ca1\u6709\u8db3\u591f\u7684\u6743\u9650\u6765\u8bbf\u95ee docker.io/library/golang \u955c\u50cf\u3002\u68c0\u67e5\u4f60\u7684 Docker \u914d\u7f6e\uff0c\u786e\u4fdd\u4f60\u6709\u9002\u5f53\u7684\u8bbf\u95ee\u6743\u9650\u3002"),(0,p.kt)("p",null,"\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\u53ef\u80fd\u5305\u62ec\uff1a"),(0,p.kt)("p",null,"\u786e\u4fdd\u4f60\u7684\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\uff0c\u80fd\u591f\u8bbf\u95ee docker.io\u3002"),(0,p.kt)("p",null,"\u9a8c\u8bc1 docker.io/library/golang \u955c\u50cf\u662f\u5426\u5b58\u5728\u548c\u53ef\u7528\u3002"),(0,p.kt)("p",null,"\u5982\u679c\u4f60\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u81ea\u5b9a\u4e49\u7684\u955c\u50cf\u6e90\uff0c\u786e\u4fdd\u914d\u7f6e\u6b63\u786e\u3002"),(0,p.kt)("p",null,"\u5982\u679c\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u5176\u4ed6\u53ef\u7528\u7684\u955c\u50cf\u6e90\u6216\u672c\u5730\u955c\u50cf\u3002"),(0,p.kt)("p",null,"\u6211\u7684\u662f\u7f51\u7edc\u8fde\u63a5\u95ee\u9898\uff0c",(0,p.kt)("inlineCode",{parentName:"p"},"ping docker.io")," \u4e0d\u901a\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"vim /etc/hosts\n\n34.205.13.154   registry-1.docker.io\n")),(0,p.kt)("p",null,"\u4fdd\u5b58\uff0c\u89e3\u51b3\u4e86\u3002"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("a",{parentName:"li",href:"https://www.cnblogs.com/ws0316/p/12066454.html"},"Docker\u62c9\u53d6\u955c\u50cf\u65f6\u9519\u8bef\u89e3\u51b3\u529e\u6cd5 - WaterStream - \u535a\u5ba2\u56ed")),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("a",{parentName:"li",href:"https://ipw.cn/dns/"},"\u57df\u540d\u89e3\u6790\u67e5\u8be2 | DNS\u67e5\u8be2 | IPv6\u89e3\u6790 | \u5728\u7ebfdig | IP\u67e5\u8be2(ipw.cn)"))),(0,p.kt)("h2",{id:"html-energy-\u6253\u5305\u7f16\u8bd1"},"html-energy \u6253\u5305\u7f16\u8bd1"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"PS D:\\Hostv\\html-energy> nvm ls\n\n    18.16.0\n  * 16.20.0 (Currently using 64-bit executable)\n    14.19.1\nPS D:\\Hostv\\html-energy> npm run build:prod\n")),(0,p.kt)("p",null,"ZD\u4e0a\u4f20\u76ee\u5f55\uff1a",(0,p.kt)("inlineCode",{parentName:"p"},"~/docker-compose/local-nginx/http")),(0,p.kt)("h2",{id:"app-system\u524d\u7aef\u9879\u76ee"},"App-System\u524d\u7aef\u9879\u76ee"),(0,p.kt)("p",null,"\u542f\u52a8\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"npx quasar dev\n")),(0,p.kt)("h2",{id:"app-iot-3"},"app-iot-3"),(0,p.kt)("h3",{id:"\u751f\u6210\u6a21\u578b"},"\u751f\u6210\u6a21\u578b"),(0,p.kt)("p",null,"\u4f7f\u7528\u7684PostgresSQL\u6570\u636e\u5e93"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'$ ./goctl-linux model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="*" -dir "./module/internal/model/" -c -home ./template/\n\ngoctl15 model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="*" -dir "./module/internal/model/" -c \ngoctl15 model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="*" -dir "./module/internal/model/" -c \n-home ./template/1.5.3\n\ngoctl15 model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="auth_module" -dir "./module/internal/model/" -c -home ./template/\n\ngoctl15 model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="casbin_rule" -dir "./module/internal/model/" -c -home ./template/\n\ngoctl15 model pg datasource --url="postgresql://iot:123123@192.168.0.96:5432/iot?sslmode=disable" --table="app_user" -dir "./module/internal/model/" -c -home ./template/\n\n')),(0,p.kt)("h3",{id:"\u751f\u6210logic"},"\u751f\u6210Logic"),(0,p.kt)("p",null,"\u4fee\u6539\u4e86",(0,p.kt)("inlineCode",{parentName:"p"},"*.api"),"\u6587\u4ef6\u4ee5\u540e\uff0c\u8fd9\u4e2a\u9700\u8981\u751f\u6210\uff0c\u56e0\u4e3a\u5e94\u7528\u4e2d\u6bd4\u5982\u8fd9\u4e2a",(0,p.kt)("inlineCode",{parentName:"p"},"app/system/internal/types/types.go"),"\u9700\u8981\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"# \u7cfb\u7edf\u540e\u53f0\ngoctl15 api go -api ./app/system/apifile/main.api -dir ./app/system/ -style gozero -home ./template\n\n# \u667a\u6167\u80fd\u6e90\ngoctl15 api go -api ./app/smartenergy/apifile/main.api -dir ./app/smartenergy/ -style gozero -home ./template\n")),(0,p.kt)("h3",{id:"\u751f\u6210ts"},"\u751f\u6210TS"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod +x ./goctl-linux\n$   ./goctl-linux api ts -api ./app/system/apifile/main.api -dir ./app/system/ts -unwrap true\n")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"$ chmod +x ./goctl-linux\n$   ./goctl-linux api ts -api ./app/smartenergy/apifile/main.api -dir ./app/smartenergy/ts -unwrap true\n")),(0,p.kt)("h3",{id:"\u751f\u6210\u4ed3\u5e93\u4ee3\u7801"},"\u751f\u6210\u4ed3\u5e93\u4ee3\u7801"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"$ chmod +x genrepo\n$ ./genrepo\n")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"root@DESKTOP-TCU7QHA:/srv/app-iot-3# ./genrepo\n./module/internal/model/iot.sql\n\u7f3a\u5c11\u6a21\u578bsql\u6587\u4ef6\u53c2\u6570 \u8fd9\u91cc\u987b\u5148\u8f6c\u50a8casbin_rule\u5355\u5f20\u8868\u5230./module/internal/model/iot.sql \u53ef\u4ee5\u5355\u5f20\u8868\u547d\u540d\u4e3aiot.sql\u5373\u53ef\nroot@DESKTOP-TCU7QHA:/srv/app-iot-3# ./genrepo\n./module/internal/model/iot.sql\ncasbin_rule\nupperModelName ==  CasbinRule\n\u751f\u6210casbin_rulecus\n")),(0,p.kt)("h2",{id:"\u65b0\u7cfb\u7edf\u4e00\u4e9b\u91cd\u6784\u6307\u4ee4"},"\u65b0\u7cfb\u7edf\u4e00\u4e9b\u91cd\u6784\u6307\u4ee4"),(0,p.kt)("p",null,"goctl-linux  1.5.4"),(0,p.kt)("p",null,"goctl15 1.5.3"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"goctl15 api go -api ./app/system/apifile/main.api -dir ./app/system/ -style gozero -home ./template\n./goctl-linux api go -api ./app/system/apifile/main.api -dir ./app/system/ -style gozero -home ./template\n")),(0,p.kt)("h2",{id:"\u5b9a\u5236\u751f\u6210ts"},"\u5b9a\u5236\u751f\u6210ts"),(0,p.kt)("p",null,"ts:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"$   ./goctl-linux api ts -api ./app/system/apifile/main.api -dir ./app/system/ts -unwrap true\n")),(0,p.kt)("p",null,"\u6216\u8005\u4f7f\u7528make\u547d\u4ee4"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"make ts APP=system\n")),(0,p.kt)("p",null,"\u6bcf\u6b21\u542f\u52a8\u9879\u76ee\u524d\u90fd\u8981\u6267\u884c\u4e00\u4e0b\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"export GOROOT=/root/sdk/go1.19\n")),(0,p.kt)("h2",{id:"app-iot-goctl-\u5b9a\u5236\u5f00\u53d1"},"app-iot-goctl \u5b9a\u5236\u5f00\u53d1"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="\\srv\\app-iot-goctl\\Makefile" showLineNumbers',title:'"\\srv\\app-iot-goctl\\Makefile"',showLineNumbers:!0},'linux:\n    CGO_ENABLED=0 GOOS=linux go build -ldflags="-s -w" -o goctl-linux goctl.go\n    $(if $(shell command -v upx), upx goctl-linux)\n')),(0,p.kt)("p",null,(0,p.kt)("inlineCode",{parentName:"p"},"$(shell command -v ...)"),"  ",(0,p.kt)("inlineCode",{parentName:"p"},"$(if ...)"),"\u51fd\u6570\u7528\u4e8e\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u3002\u5728\u4f60\u63d0\u4f9b\u7684\u793a\u4f8b\u4e2d\uff0c",(0,p.kt)("inlineCode",{parentName:"p"},"$(if $(shell command -v ...)"),"\u7684\u610f\u601d\u662f\u5224\u65ad\u4e00\u4e2a\u547d\u4ee4\u662f\u5426\u5b58\u5728\u3002"),(0,p.kt)("p",null,"\u5728\u5927\u591a\u6570Linux\u53d1\u884c\u7248\u4e2d\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5305\u7ba1\u7406\u5668\u6765\u5b89\u88c5upx\u3002\u4f8b\u5982\uff0c\u5728Ubuntu\u4e0a\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"apt-get install upx\n")),(0,p.kt)("h2",{id:"\u65b0\u5e73\u53f0\u540e\u7aef\u7f16\u8bd1\u6253\u5305\u5e76\u63a8\u9001"},"\u65b0\u5e73\u53f0\u540e\u7aef\u7f16\u8bd1\u6253\u5305\u5e76\u63a8\u9001"),(0,p.kt)("p",null,"\u751f\u4ea7\u670d\u751f\u6210json"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"./goctl-linux-p api perm --api ./app/smartenergy/apifile/main.api --o ./app/smartenergy/permission -app e1ace6bab92f27acc26b9d1d840fa8b3\n")),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},"\u540e\u7aef\u63a5\u53e3")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"make build-app APP=system\n\nmake build-app APP=smartenergy\n")),(0,p.kt)("p",null,"\u7136\u540e\u624b\u52a8\u6253\u5f00Portainer\u62c9\u53d6\u65b0\u7684Docker Image\u91cd\u5efa\u4e00\u4e0bDocker Container\u5373\u53ef\u3002"),(0,p.kt)("ol",{start:2},(0,p.kt)("li",{parentName:"ol"},"\u7cfb\u7edf\u7ba1\u7406\u540e\u53f0\u524d\u7aef")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'quasar build\n\n// \u5220\u9664\u518d\u62f7\u8d1ddisk\u76ee\u5f55\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\n//rm -rf ./gitignore/*/*\n//cp -r ./dist/spa/* ./gitignore/*/\n\n// \u63a8\u9001\u5230GIT\u4ed3\u5e93 \u53c2\u8003\u624b\u52a8\n//cd ./gitignore/*/ && git add . && git commit -m "update" && git push\n\n// \u63a8\u9001\u6253\u5305\u597d\u7684\u6587\u4ef6\u5230build\u5206\u652f   \u53c2\u8003\u624b\u52a8\n//cd ./gitignore/*/ && git tag $(VERSION) && git push origin $(VERSION)\n\n\n// \u53ea\u8981\u8fd9\u6837\u64cd\u4f5c\n1. quasar build\n2. \u987b\u8981\u5207\u6362\u5230`gitignore/app-system`\u76ee\u5f55\u4e0b,\u5220\u9664\u518d\u62f7\u8d1ddisk\u76ee\u5f55\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\n3. \u4f7f\u7528git bash here shell, git add . && git commit -m "update" && git push\n4. VERSION=$(date +"%y.%-m.%-d.%H%M%S") && git tag $VERSION && git push origin $VERSION\n\n\n// \u7136\u540e\u5230https://cd.yztiot.com/web/app-system/105\u90e8\u7f72\n')),(0,p.kt)("ol",{start:3},(0,p.kt)("li",{parentName:"ol"},"\u5e94\u7528\u540e\u53f0\u524d\u7aef\u9879\u76ee\u6253\u5305")),(0,p.kt)("p",null,"\u7c7b\u4f3c\u4e0a\u9762\u7684\u6b65\u9aa4"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'quasar build\n// \u5220\u9664`gitignore`\u518d\u62f7\u8d1d`disk`\u76ee\u5f55\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\n\n// \u5207\u6362\u5230`gitignore/app-system`\u76ee\u5f55\u4e0b\nVERSION=$(date +"%y.%-m.%-d.%H%M%S")\ngit tag $VERSION && git push origin $VERSION\n\n// \u7136\u540e\u5230https://cd.yztiot.com/web/app-system/105\u90e8\u7f72\n')))}d.isMDXComponent=!0}}]);