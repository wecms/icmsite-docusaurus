"use strict";(self.webpackChunkicmsite_docusaurus=self.webpackChunkicmsite_docusaurus||[]).push([[8683],{3905:(e,o,r)=>{r.d(o,{Zo:()=>p,kt:()=>m});var t=r(7294);function n(e,o,r){return o in e?Object.defineProperty(e,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[o]=r,e}function a(e,o){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),r.push.apply(r,t)}return r}function c(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?a(Object(r),!0).forEach((function(o){n(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}))}return e}function l(e,o){if(null==e)return{};var r,t,n=function(e,o){if(null==e)return{};var r,t,n={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],o.indexOf(r)>=0||(n[r]=e[r]);return n}(e,o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var i=t.createContext({}),s=function(e){var o=t.useContext(i),r=o;return e&&(r="function"==typeof e?e(o):c(c({},o),e)),r},p=function(e){var o=s(e.components);return t.createElement(i.Provider,{value:o},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},d=t.forwardRef((function(e,o){var r=e.components,n=e.mdxType,a=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),g=s(r),d=n,m=g["".concat(i,".").concat(d)]||g[d]||u[d]||a;return r?t.createElement(m,c(c({ref:o},p),{},{components:r})):t.createElement(m,c({ref:o},p))}));function m(e,o){var r=arguments,n=o&&o.mdxType;if("string"==typeof e||n){var a=r.length,c=new Array(a);c[0]=d;var l={};for(var i in o)hasOwnProperty.call(o,i)&&(l[i]=o[i]);l.originalType=e,l[g]="string"==typeof e?e:n,c[1]=l;for(var s=2;s<a;s++)c[s]=r[s];return t.createElement.apply(null,c)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},1581:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var t=r(7462),n=(r(7294),r(3905));const a={},c="Go-Zero",l={unversionedId:"coding/golang/go-zero",id:"coding/golang/go-zero",title:"Go-Zero",description:"Goctl CLI\u5de5\u5177",source:"@site/docs/coding/golang/go-zero.md",sourceDirName:"coding/golang",slug:"/coding/golang/go-zero",permalink:"/docs/coding/golang/go-zero",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/coding/golang/go-zero.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Golang",permalink:"/docs/coding/golang/"},next:{title:"Golang \u7684 \u201comitempty\u201d \u5173\u952e\u5b57\u7565\u89e3",permalink:"/docs/coding/golang/golang-omitempty-tag"}},i={},s=[{value:"Goctl CLI\u5de5\u5177",id:"goctl-cli\u5de5\u5177",level:2},{value:"goctl completion",id:"goctl-completion",level:3},{value:"go-zero  \u8def\u7531  api \u8bfb\u53d6",id:"go-zero--\u8def\u7531--api-\u8bfb\u53d6",level:2},{value:"\u5728Go-Zero  \u4e2d\u95f4\u4ef6 ctx\u4e0a\u4e0b\u6587",id:"\u5728go-zero--\u4e2d\u95f4\u4ef6-ctx\u4e0a\u4e0b\u6587",level:2},{value:"cortesi/modd",id:"cortesimodd",level:2},{value:"\u4e00\u4e2a\u6307\u9488\u5f15\u8d77\u7684\u5217\u8868\u6570\u636e\u4e3a\u7a7a",id:"\u4e00\u4e2a\u6307\u9488\u5f15\u8d77\u7684\u5217\u8868\u6570\u636e\u4e3a\u7a7a",level:2},{value:"\u4f20\u9012\u53c2\u6570\u5fc5\u987b\u4e3a\u6307\u9488\uff0c\u5426\u5219\u62a5\u9519 <code>reflect.Value.IsNil(...)</code>",id:"\u4f20\u9012\u53c2\u6570\u5fc5\u987b\u4e3a\u6307\u9488\u5426\u5219\u62a5\u9519-reflectvalueisnil",level:2}],p={toc:s},g="wrapper";function u(e){let{components:o,...r}=e;return(0,n.kt)(g,(0,t.Z)({},p,r,{components:o,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"go-zero"},"Go-Zero"),(0,n.kt)("h2",{id:"goctl-cli\u5de5\u5177"},"Goctl CLI\u5de5\u5177"),(0,n.kt)("p",null,"goctl \u662f go-zero \u914d\u5957\u7684\u4ee3\u7801\u751f\u6210\u5de5\u5177\u811a\u624b\u67b6\uff0c\u5176\u96c6\u6210\u4e86 Go HTTP \u670d\u52a1\uff0cGo gRPC \u670d\u52a1\uff0c\u6570\u636e\u5e93 model\uff0ck8s\uff0cDockerfile \u7b49\u751f\u6210\u529f\u80fd\u3002"),(0,n.kt)("h3",{id:"goctl-completion"},"goctl completion"),(0,n.kt)("p",null,"goctl \u91c7\u7528\u4e86 ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/spf13/cobra"},"Cobra")," \u6846\u67b6\u5f00\u53d1\uff0c\u56e0\u6b64\u5176\u7ee7\u627f\u4e86 Cobra \u7684\u81ea\u52a8\u8865\u5168\u529f\u80fd\uff0c\u5728 goctl \u4e2d\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86 bash\u3001fish\u3001zsh\u3001powershell \u7684\u81ea\u52a8\u8865\u5168\u529f\u80fd\u3002"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://go-zero.dev/docs/tutorials/cli/completion"},"goctl completion | go-zero Documentation")),(0,n.kt)("h2",{id:"go-zero--\u8def\u7531--api-\u8bfb\u53d6"},"go-zero  \u8def\u7531  api \u8bfb\u53d6"),(0,n.kt)("p",null,"go-zero  \u8def\u7531  api \u8bfb\u53d6"),(0,n.kt)("h2",{id:"\u5728go-zero--\u4e2d\u95f4\u4ef6-ctx\u4e0a\u4e0b\u6587"},"\u5728Go-Zero  \u4e2d\u95f4\u4ef6 ctx\u4e0a\u4e0b\u6587"),(0,n.kt)("p",null,"\u5728Go-Zero\u4e2d\u600e\u4e48\u628a\u8bf7\u6c42\u4e2dinternal logic\u4e2d\u7684l.ctx\u53d8\u91cf\u4f20\u9012\u5230\u4e2d\u95f4\u4ef6\u4e2d\u4f7f\u7528"),(0,n.kt)("p",null,"\u4ecerequest\u4e2d\u53ef\u4ee5\u83b7\u53d6\u4e0a\u4e0b\u6587\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},'func (m *AuthInterceptorMiddleware) Handle(next http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        ctx := r.Context()\n        uid := ctxdata.GetUserId(ctx)\n        logx.WithContext(ctx).Infof("get userid by AuthInterceptorMiddleware: %v", uid)\n        next(w, r)\n    }\n}\n')),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"go-zero \u600e\u4e48\u4e2d\u4e2d\u95f4\u4ef6\u4e2d\u4f7f\u7528servicecontext.go\u4e0a\u4e0b\u6587")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/zeromicro/go-zero/issues/867"},"\u8def\u7531\u4e2d\u95f4\u4ef6\u652f\u6301ServiceContext\u53c2\u6570\u4f20\u9012 \xb7 Issue #867 \xb7 zeromicro/go-zero"),"\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/go-zero-looklook/issues/121"},"userid\u600e\u4e48\u4f20\u9012\u7ed9\u9274\u6743\u4e2d\u95f4\u4ef6\uff1f \xb7 Issue #121 \xb7 Mikaelemmmm/go-zero-looklook")),(0,n.kt)("h2",{id:"cortesimodd"},"cortesi/modd"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"bilibili  go-zero-looklook  modd"),(0,n.kt)("li",{parentName:"ul"},"Go \u8bed\u8a00\u7684\u70ed\u52a0\u8f7d"),(0,n.kt)("li",{parentName:"ul"},"golang air \u6307\u5b9a\u7248\u672c"),(0,n.kt)("li",{parentName:"ul"},"\u76d1\u542c\u4e0a\u7ea7\u76ee\u5f55")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/cortesi/modd"},"cortesi/modd\uff1a\u4e00\u79cd\u7075\u6d3b\u7684\u5f00\u53d1\u4eba\u5458\u5de5\u5177\uff0c\u53ef\u8fd0\u884c\u8fdb\u7a0b\u5e76\u54cd\u5e94\u6587\u4ef6\u7cfb\u7edf\u66f4\u6539")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/go-zero-looklook/blob/main/modd.conf"},"go-zero-looklook/modd.conf at main \xb7 Mikaelemmmm/go-zero-looklook"),"\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/Mikaelemmmm/go-zero-looklook/blob/main/doc/chinese/01-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.md"},"go-zero-looklook/doc/chinese/01-\u5f00\u53d1\u73af\u5883\u642d\u5efa.md at main \xb7 Mikaelemmmm/go-zero-looklook")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://razonyang.com/zh-hans/posts/go/modd/"},"\u5229\u7528 Modd \u63d0\u9ad8 Go \u5f00\u53d1\u6548\u7387 - Razon Yang")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://juejin.cn/post/7075521293549830152"},"Modd \u70ed\u7f16\u8bd1\u91cd\u542f Go \u9879\u76ee - \u6398\u91d1")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://space.bilibili.com/389552232/video?tid=0&pn=2&keyword=&order=pubdate"},"Mikaelemmmm\u7684\u4e2a\u4eba\u7a7a\u95f4_\u54d4\u54e9\u54d4\u54e9_bilibili")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/cosmtrek/air"},"cosmtrek/air: \u2601\ufe0f Live reload for Go apps")),(0,n.kt)("h2",{id:"\u4e00\u4e2a\u6307\u9488\u5f15\u8d77\u7684\u5217\u8868\u6570\u636e\u4e3a\u7a7a"},"\u4e00\u4e2a\u6307\u9488\u5f15\u8d77\u7684\u5217\u8868\u6570\u636e\u4e3a\u7a7a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},'QueryDetailRes struct {\n    Id          int64  `db:"id"`\n    AppKey      string `db:"app_key"`\n    UserId      int64  `db:"user_id"` // user\u8868id\n    RoleId      *int64 `db:"role_id"`\n    CreatedBy   int64  `db:"created_by"`   // \u9080\u8bf7/\u521b\u5efa\u8005\u7528\u6237id\n    Openid      string `db:"openid"`       // \u5173\u8054\u5e94\u7528\u7684\u5c0f\u7a0b\u5e8fopenid\uff0c\u4e0d\u540c\u5e94\u7528\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e0d\u540c\u5c0f\u7a0b\u5e8f\n    Unionid     string `db:"unionid"`      // \u5173\u8054\u5e94\u7528\u7684\u5c0f\u7a0b\u5e8funionid\n    EnableAlarm int64  `db:"enable_alarm"` // \u662f\u5426\u63a5\u6536\u63a8\u9001\u6d88\u606f\n    //        \u4e0b\u9762\u4fe1\u606f\u6765\u81eauser\u8868\n    Username  string       `db:"username"`\n    Avatar    string       `db:"avatar"`\n    Nickname  string       `db:"nickname"`\n    Mobile    string       `db:"mobile"`\n    Email     string       `db:"email"`\n    CreatedAt sql.NullTime `db:"created_at"`\n}\n')),(0,n.kt)("p",null,"\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5b57\u6bb5"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},'RoleId      *int64 `db:"role_id"`\n')),(0,n.kt)("p",null,"\u662f\u7ecf\u8fc7TortoiseGit\u5bf9\u6bd4\u770b\u51fa\u6765\u7684\uff0c\u627e\u4e86\u5f88\u4e45\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6570\u636e\u4e3a\u7a7a\uff0cSQL\u67e5\u8be2\u662f\u6709\u7ed3\u679c\u7684\u3002"),(0,n.kt)("p",null,"\u8ffd\u8e2a\u4ee3\u7801\u5f88\u6df1\uff0c\u4e00\u76f4\u8ffd\u8e2a\u5230\u8fd9\u91cc\uff0c\u672a\u67e5\u5230\u679c\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"# \\\\wsl$\\Ubuntu-20.04\\srv\\app-iot-go\\module\\internal\\model\\appusermodel.go\n\nfunc (m *customAppUserModel) QueryRawsNoCacheCtx(ctx context.Context, v any, q string, args ...any) error {\n    return m.defaultAppUserModel.QueryRowsNoCacheCtx(ctx, v, q, args...)\n}\n")),(0,n.kt)("p",null,"\u6700\u540e\u6253\u5370\u53d1\u73b0\u662f\u5c11\u4e00\u4e2a\u67e5\u8be2\u5b57\u6bb5\u5bfc\u81f4\u7684\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},'# \\\\wsl$\\Ubuntu-20.04\\root\\go\\pkg\\mod\\github.com\\zeromicro\\go-zero@v1.5.3\\core\\stores\\sqlx\\sqlconn.go\nfunc (db *commonSqlConn) QueryRowsCtx(ctx context.Context, v any, q string,\n    args ...any) (err error) {\n    ctx, span := startSpan(ctx, "QueryRows")\n    defer func() {\n        endSpan(span, err)\n    }()\n\n    return db.queryRows(ctx, func(rows *sql.Rows) error {\n        columns,_:=rows.Columns()\n        fmt.Printf("columns:",columns) // \u6211\u5728\u8fd9\u91cc\u6253\u5370\u4e86\u67e5\u8be2\u5b57\u6bb5\n        return unmarshalRows(v, rows, true)\n    }, q, args...)\n}\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},'# module/internal/repository/appuser/repository.go\n// queryDetailBuilder \u67e5\u8be2\u8be6\u60c5\u6784\u9020\u5668 \u8fde\u540cuser\u8868\u7684\u6570\u636e\u67e5\u8be2\u51fa\u6765\n// \u6ce8 \uff1a \u5728 PostgreSQL \u4e2d\uff0cuser \u662f\u4e00\u4e2a\u4fdd\u7559\u5173\u952e\u5b57\uff0c\u6240\u4ee5\u9700\u8981\u7528\u53cc\u5f15\u53f7\u5f15\u8d77\u6765\nfunc (r *customRepository) queryDetailBuilder(ctx context.Context, query any, orderBy ...any) squirrel.SelectBuilder {\n    bd := squirrel.Select("app_user.id," +\n        "app_user.app_key," +\n        "app_user.user_id," +\n        "app_user.role_id," +\n        "app_user.created_by," +\n        "app_user.openid," +\n        "app_user.unionid," +\n        "app_user.enable_alarm," +\n        "\\"user\\".username," +\n        "\\"user\\".avatar," +\n        "\\"user\\".nickname," +\n        "\\"user\\".mobile," +\n        "\\"user\\".email," +\n        "\\"user\\".created_at").From("app_user").\n        Join("\\"user\\" on app_user.user_id = \\"user\\".id")\n')),(0,n.kt)("p",null,'\u95eeAI\u8bf4\uff0c\u5728\u4f7f\u7528 Squirrel SQL \u7684 Select \u65b9\u6cd5\u65f6\u5982\u679c\u6f0f\u6389\u4e86\u4e00\u4e2a\u5b57\u6bb5\uff0c\u6bd4\u5982 "column3"\uff0c\u90a3\u4e48\u5728 rows.Scan() \u4e2d\u5c1d\u8bd5\u626b\u63cf "column3" \u7684\u503c\u65f6\uff0c\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u5bfc\u81f4\u6574\u4e2a\u884c\u7684\u626b\u63cf\u5931\u8d25\u3002\u8fd9\u4e5f\u4f1a\u5bfc\u81f4\u7ed3\u679c\u4e3a\u7a7a\uff0c\u56e0\u4e3a\u6ca1\u6709\u6210\u529f\u626b\u63cf\u5230\u5b8c\u6574\u7684\u884c\u6570\u636e\u3002'),(0,n.kt)("h2",{id:"\u4f20\u9012\u53c2\u6570\u5fc5\u987b\u4e3a\u6307\u9488\u5426\u5219\u62a5\u9519-reflectvalueisnil"},"\u4f20\u9012\u53c2\u6570\u5fc5\u987b\u4e3a\u6307\u9488\uff0c\u5426\u5219\u62a5\u9519 ",(0,n.kt)("inlineCode",{parentName:"h2"},"reflect.Value.IsNil(...)")),(0,n.kt)("p",null,"\u4e0d\u77e5\u9053\u662f\u540c\u4e8b\u5199\u7684\u4ee3\u7801\u6709\u95ee\u9898\uff0c\u8fd8\u662f\u4ec0\u4e48\u539f\u56e0\uff1f\uff1f\uff1f"),(0,n.kt)("p",null,"DetailPaginate(ctx, v, page, pageSize, q, o) // \u8fd9\u91cc\u7684q, o\u90fd\u8981\u52a0&\u5426\u5219\u62a5\u4e0b\u9762\u9519"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"# module/auth/service/appuser/svc.go\n\nfunc (s *Service) Paginate(ctx context.Context, v any, page uint64, pageSize uint64, query *ParamQuery, order *ParamOrder) (currentPage uint64, perPage uint64, maxPage uint64, total uint64, err error) {\n    var (\n        q appuser.ParamQuery\n        o appuser.ParamOrder\n    )\n    _ = bizcopier.CopyWithConverters(&q, query)\n    _ = bizcopier.CopyWithConverters(&o, order)\n\n    //currentPage, perPage, maxPage, total, err = s.svcCtx.AppUserRepo.Paginate(ctx, v, page, pageSize, &q, &o)\n\n    //currentPage, perPage, maxPage, total, err = s.svcCtx.AppUserRepo.DetailPaginate(ctx, v, page, pageSize, &q, &o)\n    currentPage, perPage, maxPage, total, err = s.svcCtx.AppUserRepo.DetailPaginate(ctx, v, page, pageSize, q, o) // \u8fd9\u91cc\u7684q, o\u90fd\u8981\u52a0&\u5426\u5219\u62a5\u4e0b\u9762\u9519\u8bef\n\n    return\n}\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"(/api/auth/app-user/list - 192.168.50.1:54345) reflect: call of reflect.Value.IsNil on struct Value goroutine 27 [running]:\nruntime/debug.Stack()\n/root/sdk/go1.19/src/runtime/debug/stack.go:24 +0x65\ngithub.com/zeromicro/go-zero/rest/handler.RecoverHandler.func1.1()\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/recoverhandler.go:16 +0x66\npanic({0x10b14a0, 0xc0003ac918})\n/root/sdk/go1.19/src/runtime/panic.go:884 +0x212\nreflect.Value.IsNil(...)\n/root/sdk/go1.19/src/reflect/value.go:1554\ngit.yztiot.com/gdyz/app-iot-go/module/internal/repository/appuser.(*customRepository).queryDetailBuilder(0xc00033ee68, {0x13ff378, 0xc000825f20}, {0x11ef9c0, 0xc0003bb180}, {0xc0008a18b8, 0x1, 0x18?})\n/srv/app-iot-go/module/internal/repository/appuser/repository.go:189 +0x707\ngit.yztiot.com/gdyz/app-iot-go/module/internal/repository/appuser.(*customRepository).DetailGet(0xc00033ee68, {0x13ff378, 0xc000825f20}, {0x102de00, 0xc0003ac858}, {0x11ef9c0?, 0xc0003bb180?}, {0x1122180?, 0xc000497370?}, 0xc0008a1930, ...)\n/srv/app-iot-go/module/internal/repository/appuser/repository.go:105 +0x85\ngit.yztiot.com/gdyz/app-iot-go/module/internal/repository/appuser.(*customRepository).DetailPaginate(0xc00033ee68, {0x13ff378, 0xc000825f20}, {0x102cb00, 0xc0003ac750}, 0xc0004d57c0?, 0x14, {0x11ef9c0, 0xc0003bb180}, {0x1122180, ...})\n/srv/app-iot-go/module/internal/repository/appuser/repository.go:127 +0x1eb\ngit.yztiot.com/gdyz/app-iot-go/module/auth/service/appuser.(*Service).Paginate(0xc00033eeb0, {0x13ff378, 0xc000825f20}, {0x102cb00, 0xc0003ac750}, 0xc0003ac6c0?, 0x30?, 0xc0008a1af0?, 0x40d5f4?)\n/srv/app-iot-go/module/auth/service/appuser/svc.go:72 +0x1b0\ngit.yztiot.com/gdyz/app-iot-go/app/system/internal/logic/auth.(*AppUserListLogic).AppUserList(0xc0008a1bc8, 0xc000825f50)\n/srv/app-iot-go/app/system/internal/logic/auth/appuserlistlogic.go:45 +0x1ad\ngit.yztiot.com/gdyz/app-iot-go/app/system/internal/handler/auth.AppUserListHandler.func1({0x13fe1b0, 0xc000328ba0}, 0xc000892900)\n/srv/app-iot-go/app/system/internal/handler/auth/appuserlisthandler.go:22 +0x19d\nnet/http.HandlerFunc.ServeHTTP(0xc0008a1cc0?, {0x13fe1b0?, 0xc000328ba0?}, 0xc000497080?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.Authorize.func1.1({0x13fe1b0, 0xc000328ba0}, 0xc000892800)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/authhandler.go:81 +0x4b3\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1b0?, 0xc000328ba0?}, 0x0?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.GunzipHandler.func1({0x13fe1b0, 0xc000328ba0}, 0xc000892800)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/gunziphandler.go:26 +0xe9\nnet/http.HandlerFunc.ServeHTTP(0xedc716664?, {0x13fe1b0?, 0xc000328ba0?}, 0x1fa8f5c05?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.MaxBytesHandler.func2.1({0x13fe1b0?, 0xc000328ba0?}, 0x1cb1fc0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/maxbyteshandler.go:24 +0xff\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1b0?, 0xc000328ba0?}, 0x0?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.MetricHandler.func1.1({0x13fe1b0, 0xc000328ba0}, 0x0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/metrichandler.go:21 +0xd5\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1b0?, 0xc000328ba0?}, 0x0?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.RecoverHandler.func1({0x13fe1b0?, 0xc000328ba0?}, 0x0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/recoverhandler.go:21 +0x83\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1b0?, 0xc000328ba0?}, 0x0?)\n/root/sdk/go1.19/src/net/http/server.go:2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.(*timeoutHandler).ServeHTTP.func1()\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/timeouthandler.go:81 +0x7c\ncreated by github.com/zeromicro/go-zero/rest/handler.(*timeoutHandler).ServeHTTP\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/timeouthandler.go:75 +0x350\n\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"# app/system/internal/logic/auth/modulelistalllogic.go\nfunc (l *ModuleListAllLogic) ModuleListAll(req *types.ModuleListAllReq) (resp *types.ModuleListAllRes, err error) {\n    var params module.ParamQuery\n\n    if req.Keyword != nil {\n        params.Name = req.Keyword\n    }\n    order := module.ParamOrder{\n        Id:        tea.String(repository.OrderDesc),\n        CreatedAt: tea.String(repository.OrderDesc),\n    }\n\n    var data []*types.ModuleDetailRes\n\n    err = l.svcCtx.AuthSvc.Module.Get(l.ctx, &data, &params, order, nil, nil)  // \u8fd9\u91ccorder\u5e94\u8be5\u4e3a&order\u5426\u5219\u62a5\u4e0b\u9762\u9519\u8bef\n    ...\n\n    return\n}\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'(/api/auth/module/list-all - "<<<<192.168.50.1":55909) "reflect": call of reflect.Value.IsNil on struct Value\ngoroutine 43 [running]:\nruntime/debug.Stack()\n/root/sdk/go1.19/src/runtime/debug/stack.go:24 "+0x65\ngithub.com/zeromicro/go-zero/rest/handler.RecoverHandler.func1.1()\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/recoverhandler.go":16 +0x66\npanic({0x10b14a0, 0xc0007fdcc8})\n/root/sdk/go1.19/src/runtime/panic.go:884 "+0x212\nreflect.Value.IsNil(...)\n/root/sdk/go1.19/src/reflect/value.go":1554\ngit.yztiot.com/gdyz/app-iot-go/common/repository/abstract.(*BaseRepository).QueryBuilder(0xc0004107b0, {0x13ff398, 0xc000a41920}, {0x10352c0, 0xc0007e4230}, {0xc000a5fa70, 0x1, 0xc000111310?})\n/srv/app-iot-go/common/repository/abstract/base.go:372 +0x6f5\ngit.yztiot.com/gdyz/app-iot-go/common/repository/abstract.(*BaseRepository).Get(0xc000a5fb18?, {0x13ff398, 0xc000a41920}, {0x102cf80, 0xc0007fdc80}, {0x10352c0?, 0xc0007e4230?}, {0x1121b40?, 0xc000111310?}, 0x0, "...)\n/srv/app-iot-go/common/repository/abstract/base.go":105 "+0x86\ngit.yztiot.com/gdyz/app-iot-go/module/auth/service/module.(*Service).Get(...)\n/srv/app-iot-go/module/auth/service/module/svc.go":100\ngit.yztiot.com/gdyz/app-iot-go/app/system/internal/logic/auth.(*ModuleListAllLogic).ModuleListAll(0xc000a5fbc8, "0xc00045ac28)\n/srv/app-iot-go/app/system/internal/logic/auth/modulelistalllogic.go":42 +0x19a\ngit.yztiot.com/gdyz/app-iot-go/app/system/internal/handler/auth.ModuleListAllHandler.func1({0x13fe1d0, 0xc000a176e0}, "0xc000a4ec00)\n/srv/app-iot-go/app/system/internal/handler/auth/modulelistallhandler.go":22 +0x19d\nnet/http.HandlerFunc.ServeHTTP(0xc000a5fcc0?, {0x13fe1d0?, 0xc000a176e0?}, "0xc000110f30?)\n/root/sdk/go1.19/src/net/http/server.go":2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.Authorize.func1.1({0x13fe1d0, 0xc000a176e0}, "0xc000a4eb00)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/authhandler.go":81 +0x4b3\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1d0?, 0xc000a176e0?}, "0x0?)\n/root/sdk/go1.19/src/net/http/server.go":2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.GunzipHandler.func1({0x13fe1d0, 0xc000a176e0}, "0xc000a4eb00)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/gunziphandler.go":26 +0xe9\nnet/http.HandlerFunc.ServeHTTP(0xedc716b66?, {0x13fe1d0?, 0xc000a176e0?}, "0xbfb241601?)\n/root/sdk/go1.19/src/net/http/server.go":2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.MaxBytesHandler.func2.1({0x13fe1d0?, 0xc000a176e0?}, "0x1cb1fc0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/maxbyteshandler.go":24 +0xff\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1d0?, 0xc000a176e0?}, "0x0?)\n/root/sdk/go1.19/src/net/http/server.go":2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.MetricHandler.func1.1({0x13fe1d0, 0xc000a176e0}, "0x0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/metrichandler.go":21 +0xd5\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1d0?, 0xc000a176e0?}, "0x0?)\n/root/sdk/go1.19/src/net/http/server.go":2109 +0x2f\ngithub.com/zeromicro/go-zero/rest/handler.RecoverHandler.func1({0x13fe1d0?, 0xc000a176e0?}, "0x0?)\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/recoverhandler.go":21 +0x83\nnet/http.HandlerFunc.ServeHTTP(0x0?, {0x13fe1d0?, 0xc000a176e0?}, "0x0?)\n/root/sdk/go1.19/src/net/http/server.go":2109 "+0x2f\ngithub.com/zeromicro/go-zero/rest/handler.(*timeoutHandler).ServeHTTP.func1()\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/timeouthandler.go":81 +0x7c\ncreated by "github.com/zeromicro/go-zero/rest/handler.(*timeoutHandler).ServeHTTP\n/root/go/pkg/mod/github.com/zeromicro/go-zero@v1.5.3/rest/handler/timeouthandler.go":75 +0x350\n')))}u.isMDXComponent=!0}}]);